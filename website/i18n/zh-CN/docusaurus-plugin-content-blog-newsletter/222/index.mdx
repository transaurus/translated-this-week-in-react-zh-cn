---
slug: /222
title: "This Week In React #222: CRA, React Router, captureOwnerStack, TanStack, CTRA, tRPC, Astro, Preact | RN 0.78, React 19, Expo, noCompress, JitPack, CRNL, Screens | TC39, Interop, TS, CSS, Node.js, Deno"
authors: [slorber]
date: 02-19-2025
---

大家好！

本周我们有两篇来自React和React Native核心团队的官方博文！CRA已正式弃用，React Native 0.78版本发布并支持React 19。

🎂 我们还在庆祝这份简报的五周年纪念日！[首期内容](https://substack.thisweekinreact.com/p/react-hebdo-sebastien-lorber-1-20-02-13)发布于2月13日，前两年仅提供法语版本。很想知道早期读者是谁——如果你是从那时开始阅读的，请打个招呼！😀

查看我们的合作伙伴会议**[React Native Connection](https://reactnativeconnection.io/?utm_source=thisweekinreact)** - 🇫🇷 巴黎 - 4月1-2日 - 使用代码"TWIR"可享15%折扣。法国React Native大会强势回归，演讲嘉宾包括Britta Evans-Fenton（Shopify）、Kadi Kraman（Expo）、Krzysztof Piaskowy（Software Mansion）、Saad Najmi（微软）等，并带来深度技术分享！

<!-- truncate -->

import Support from "../_support.mdx";

<Support />

---

## 💸 赞助 {#sponsor1}

[![PropelAuth：让认证成为你的优势](/emails/issues/218/propelauth.jpg)](https://www.propelauth.com/?utm_source=newsletter&utm_campaign=twinrfeb192024)

**[PropelAuth：让认证成为你的优势](https://www.propelauth.com/?utm_source=newsletter&utm_campaign=twinrfeb192024)**

如果你的认证系统不能**助力业务增长**，那它就是在**拖后腿**。

通过[PropelAuth](https://www.propelauth.com/?utm_source=newsletter&utm_campaign=twinrjan222024)，你将获得B2B产品启动和扩展所需的一切：

- **清晰易懂**的[文档](https://docs.propelauth.com/?utm_source=newsletter&utm_campaign=twinrjan222024)和**友好、快速的响应支持**
- **覆盖全场景的UI组件**——注册、登录、多因素认证、组织管理等
- **用户模拟功能**助你为用户提供顶级技术支持
- **企业级SAML/SSO**和**高级安全特性**满足高端市场需求
- **用户行为分析**助力战略决策与业务拓展

[立即开始使用](https://www.propelauth.com/?utm_source=newsletter&utm_campaign=twinrjan222024)

---

## ⚛️ React {#react}

[![Create React App正式退役](/emails/issues/222/cra.jpg)](https://react.dev/blog/2025/02/14/sunsetting-create-react-app)

**[Create React App正式退役](https://react.dev/blog/2025/02/14/sunsetting-create-react-app)**

姗姗来迟的更新：CRA已获得React 19最新补丁并正式宣告弃用。本文阐述了CRA和构建工具在路由、瀑布流、代码分割等方面的局限性。React团队建议采用Next.js、React Router或Expo等框架来解决这些问题。当然，你仍可以使用Vite、Parcel、Rsbuild等现代构建工具[从零搭建React应用](https://react.dev/learn/build-a-react-app-from-scratch)。

该声明最初在X平台和GitHub上引发激烈争论，主要因其过度强调框架而忽视了Vite等构建工具。相关说明[很快被更新](https://github.com/reactjs/react.dev/pull/7624)以回应这些关切。这也促成了[尤雨溪（Vite）与React团队](https://github.com/facebook/react/pull/31768#issuecomment-2666856223)潜在的合作机会，双方将共同开发与React Server Components集成的"官方"方案，并承诺在React代码库中长期维护该集成。

相关动态：

- 📜 [使用框架构建React Native应用](https://reactnative.dev/blog/2024/06/25/use-a-framework-to-build-react-native-apps): 数月前，React Native团队曾发布类似声明，称"你要么使用框架，要么就在自建框架"。
- 📦 [Create TanStack Router应用](https://github.com/TanStack/create-tsrouter-app): Jack Herrington对TanStack的首个贡献，作为Create-React-App的替代方案，他还在[视频](https://www.youtube.com/watch?v=10J6RyMOxN0)中介绍了该工具。
- 📦 [CRA迁移至Parcel](https://github.com/parcel-bundler/cra-to-parcel): 将未执行eject的Create React App项目迁移到Parcel的脚本工具

---

- 💸 [工程师的产品选择之道](https://dub.link/twir-feb19)
- 📣 [Vercel 宣布支持 React Router v7](https://vercel.com/changelog/support-for-react-router-v7)：在框架模式下提供对 React Router 的一流支持，并支持基于新型优化 Fluid 计算的无服务器 SSR 功能。
- 📖 [React 核心文档 - `captureOwnerStack()`](https://react.dev/reference/react/captureOwnerStack)：这个新的实验性 React 核心 API 近期已解除标记限制并正式纳入文档。它特别适合框架开发者用来增强自定义错误覆盖层。不出所料，Next.js 正在开发一个利用该 API 的新覆盖层（[示例](https://x.com/sebastienlorber/status/1890361565960151374)）。
- 📖 [Vercel AI 文档 - Next.js 中的人机协同](https://sdk.vercel.ai/cookbook/next/human-in-the-loop)：一个在 LLM 工具调用前要求用户进行是/否确认的实践方案。
- 📜 [全新 TanStack React Query 集成方案发布](https://trpc.io/blog/introducing-tanstack-react-query-client)：即将发布的 tRPC v11 处于 RC 阶段，它利用 React Query 的 `queryOptions()` 移除了抽象层：现在你可以直接使用原生 `useQuery()` 替代 tRPC 封装器。
- 📜 [用 LLMs 和 React 设计背景](https://www.vigilant.run/blog/designing-backgrounds-with-llms-and-react)：像 Cursor 这样的工具能出色地创作艺术风格的 React 组件。
- 📜 [使用 Vitest 对 styled-components 进行快照测试](https://brightinventions.pl/blog/snapshot-testing-styled-components-with-vitest/)：现有的 StyledComponents Jest 快照序列化器同样兼容 Vitest。虽然我不推荐对样式进行快照测试（更倾向于[视觉回归测试](https://docusaurus.io/blog/upgrading-frontend-dependencies-with-confidence-using-visual-regression-testing)），但这可能帮助现有代码库迁移到 Vitest。
- 📜 [我看好 Next.js 的未来](https://tigerabrodi.blog/i-like-the-future-of-nextjs)：关于动态 IO、PPR 和 `use cache` 指令的思考。
- 📜 [TypeScript 实现 React 的 "as" 属性](https://playfulprogramming.com/posts/react-as-prop)
- 📜 [火焰图中的客户端渲染分析](https://www.developerway.com/posts/client-side-rendering-flame-graph)
- 📜 [2025 年值得关注的 React 库](https://www.robinwieruch.de/react-libraries/)
- 📜 [Tanstack Start - 它是下一个 NextJS 吗？](https://spin.atomicobject.com/tanstack-start-nextjs/)
- 📦 [React Router 7.2 - 类型安全的 `href()` 工具](https://github.com/remix-run/react-router/blob/main/CHANGELOG.md#v720)：提供路由路径自动补全和参数验证的实用改进。该版本还包含对 SPA 回退静态文件的支持，以及两个新特性标志 `unstable_splitRouteModules` 和 `unstable_viteEnvironmentApi`。
- 📦 [TanStack Start 1.107 - 为服务端函数添加 AbortSignal](https://tanstack.com/start/latest/docs/framework/react/server-functions#cancellation)
- 📦 [Astro 5.3 - 更快的 SSR，自动会话存储配置](https://astro.build/blog/astro-530/)
- 📦 [Preact 10.26 - 支持 React 19 的 `<Context>`](https://github.com/preactjs/preact/releases/tag/10.26.0)
- 📦 [9ui - 基于 Base UI 和 Tailwind CSS 构建的优雅可定制组件](https://www.9ui.dev/)：采用 shadcn 分发模式，但使用 Base UI 这个 Radix 的新兴替代方案。作者还在移植 Vaul、cmdk 等流行库。
- 📦 [Kokonut UI - 专为 Next.js 和 React 打造的 Tailwind CSS 组件集合](https://kokonutui.com/)：另一个采用 shadcn 分发模式的方案。
- 📦 [React Bits - 用于构建惊艳用户界面的动画交互式 React 组件集合](https://github.com/DavidHDev/react-bits)
- 🎥 [Alem Tuzlak - 理解 react-router 的服务端/客户端边界](https://www.youtube.com/watch?v=zyQjzId0H7s)
- 🎙️ [前端之火第 81 期 - React 现状调研结果、TypeScript 5.8 和 v0 升级](https://front-end-fire.com/episodes/81/)

<SubscribeFormEmbed placement="middle" />

---

## 💸 赞助商 {#sponsor2}

[![用Reactile重新思考React应用的用户体验](/emails/issues/216/reactile.jpg)](https://www.reactile.net/?utm_source=ThisweekinReact)

**[用Reactile重新思考React应用的用户体验](https://www.reactile.net/?utm_source=ThisweekinReact)**

Reactile是一个开箱即用的UI/UX框架，提供直观的平铺式工作区布局。它能在单一浏览器标签页内为大型Web解决方案实现并行工作负载。开发者只需用React实现自定义视图容器、组件和业务逻辑，Reactile会为您处理显示逻辑。

此外，Reactile还提供：

- 基于Promise的持久化机制，实现跨设备跨时段的工作流一致性
- 支持嵌套标签页的平铺布局
- 简化的全局搜索机制
- 基于CSS @container的响应式设计
- 以及更多功能

第二版即将发布。立即开启30天免费试用，访问reactile.net了解更多。

[Reactile - 新一代React UI管理系统](https://www.reactile.net/price?utm_source=ThisweekinReact)

---

## 📱 React-Native {#react-native}

[![React Native 0.78 - 支持React 19等新特性](/emails/issues/222/rn.jpg)](https://reactnative.dev/blog/2025/02/19/react-native-0.78)

**[React Native 0.78 - 支持React 19等新特性](https://reactnative.dev/blog/2025/02/19/react-native-0.78)**

团队近期决定采用更频繁的小版本发布节奏，本次更新亮点包括：

- 支持React 19！
- 简化了启用React编译器的流程
- Metro日志流功能在0.78和0.77.1版本回归（需通过新参数`--client-logs`启用，仍属弃用状态）
- `<Image>`组件支持Android XML资源，可能带来性能提升
- iOS端新增`ReactNativeFactory`，便于现有ViewController集成

React 19本身带来诸多新特性：

- Actions（异步状态转换）、`useActionState()`和`useOptimistic()`，助力表单提交与加载/错误/乐观状态管理
- 可直接使用`ref`属性替代`forwardRef()`，并支持ref清理函数
- 使用简化的`<Context>`语法替代`<Context.Provider>`
- 通过`use()`读取上下文和Promise

---

- 💸 [Codemagic - React Native 开发者的绝佳 App Center 替代方案！构建速度提升 8 倍，支持 CodePush 和自动化分发。提供 1 个月免费试用！](https://codemagic.io/migration-from-app-center/?utm_source=newsletter&utm_medium=email&utm_campaign=app_center_this_week_react)
- 📣 [Expo 对 React Native 0.78 的支持](https://expo.dev/changelog/react-native-78)：由于 React 19 的升级，v0.78 将不会在 SDK52 中得到支持，但会在 canary 版本中提供。SDK 53 计划于今年春季发布，并可能直接升级到 0.79。
- 👀 [Gradle 插件 PR - 新增禁用 bundle 压缩的选项](https://github.com/facebook/react-native/pull/49449)：Marc Rousavy 提议添加 `react.enableBundleCompression` Gradle 属性。关闭该选项可以显著优化 Android 应用的启动时间（现已成为新默认值），但也会增加应用安装包体积。
- 💬 [使 JitPack 仓库变为可选](https://github.com/react-native-community/discussions-and-proposals/discussions/877)：从 v0.78 开始，Android 应用新增 `react.includeJitpackRepository=true` Gradle 属性。关闭该选项可提升供应链安全性，未来可能成为默认设置。
- 📜 [复选框交互 - 布局动画之美](https://reactiive.io/articles/checkbox-interactions)
- 📜 [使用 Expo 构建通用应用](https://www.premieroctet.com/blog/en/universal-app-with-expo)
- 📦 [Create React Native Library 0.48 - 支持 Nitro 模块](https://github.com/callstack/react-native-builder-bob/releases/tag/create-react-native-library%400.48.0)
- 📦 [React Native Screens 4.7 - 修复 Android formSheet 转场问题](https://github.com/software-mansion/react-native-screens/releases/tag/4.7.0)
- 📦 [Expo AI 聊天机器人 - 使用 Expo + Next.js 构建通用聊天机器人的入门模板，含高级选项](https://www.expoaichatbot.com/)
- 🎥 [Expo - EAS 工作流：面向应用开发者的 React Native CI/CD](https://www.youtube.com/watch?v=OJ2u9tQCpr4)
- 🎥 [Catalin Miron - Apple 邀请函动画](https://www.youtube.com/watch?v=P_gYeiFipsk)
- 🎥 [Simon Grimm - 构建移动应用的最快方式（AI + Expo = 魔法）](https://www.youtube.com/watch?v=fJb6f2Sw4Ek)
- 🎙️ [React Universe On Air 第 48 期 - Reanimated 4 是 React Native 流畅动画的未来](https://www.youtube.com/watch?v=wAfJqFX62ag)

---

## 🔀 其他 {#other}

- 📣 [TC39 - 第 106 次会议议程](https://github.com/tc39/agendas/blob/main/2025/02.md)：会议正在进行中。多项重要提案已取得进展，包括 `RegExp.escape()`、`import defer`、`Math.clamp()` 等。
- 📣 [Interop 2025](https://web.dev/blog/interop-2025)：浏览器厂商已优先合作开发 CSS 锚点定位、视图过渡 API、导航 API 等激动人心的功能。
- 📣 [ESLint 正式支持 CSS 代码检查](https://eslint.org/blog/2025/02/eslint-css-support/)
- 📜 [依赖项打包（以及何时不需要打包）](https://e18e.dev/blog/bundling-dependencies.html)
- 📜 [CSS @function + CSS if() = 🤯](https://www.bram.us/2025/02/18/css-at-function-and-css-if/)
- 📜 [Node.js 的 Mock 方式已彻底改变](https://kettanaito.com/blog/mocking-in-nodejs-has-just-changed-forever)
- 📦 [TypeScript 5.8 RC - `erasableSyntaxOnly`、`require(esm)`、依赖返回类型收窄](https://devblogs.microsoft.com/typescript/announcing-typescript-5-8-rc/)
- 📦 [Node 23.8 - 新增 `URLPattern` API、线程命名、zstd 压缩、使用系统 CA](https://nodejs.org/en/blog/release/v23.8.0)
- 📦 [Node 22.14 - 新增 `findPackageJSON`、glob `exclude`、修复 Corepack pnpm 问题](https://nodejs.org/en/blog/release/v22.14.0)
- 📦 [Deno 2.2 - 支持 OpenTelemetry、Lint 插件、`node:sqlite`](https://deno.com/blog/v2.2)

## 🤭 趣味 {#fun}

[![alt](/emails/issues/222/meme.jpg)](https://bsky.app/profile/sebastienlorber.com/post/3lifbkotlfc2v)

[![alt](/emails/issues/222/meme2.jpg)](https://x.com/sebastienlorber/status/1891548981848834219)

回见！👋