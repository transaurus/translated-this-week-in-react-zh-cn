---
slug: /185
title: "This Week In React #185: React Conf, useDeferredValue, React Query, refs, Next.js after, mini-react, Astro, MDXTS, Radix, Solid, Redwood, Pigment, Apollo, Playwright, Re.Pack, RN-Model3D, RN perf, RN Video, VisionOS, LiveView, Anchor Positioning ..."
authors: [slorber, bndkt]
date: 05-15-2024
---

大家好！

本周的版本发布相对平静（至少目前如此）！我们有不少优质的React技术文章，但同时也看到一些批评声音，或是推荐替代方案（如Solid、Phoenix LiveView）的内容 😅。

React Conf今天晚些时候就要开始了！我们期待会上公布的重要更新，下周会为大家详细报道。今天我特意提前发送简报，确保能无压力地观看直播 😄。

[React Conf YouTube直播链接](https://www.youtube.com/watch?v=T8TZQ6k4SLE)已开放。查看[会议议程](https://conf.react.dev/agenda)后，我们特别期待以下演讲：

- React与React Native主题演讲及问答环节
- Expo Router中的通用React服务端组件 - Evan Bacon（Expo）
- 实时服务端组件 - Sunil Pai（PartyKit）
- 用React开发空间计算应用 - Michał Pierzchała（Callstack）
- 跨平台React开发 - Olga Zinoveva与Naman Goel（Meta）

说到会议，美国React Native大会[**Chain React**](https://chainreactconf.com/?utm_source=thisweekinreact)将于7月17-19日回归（波特兰/俄勒冈州）。我们合作提供15%门票折扣，优惠码"TWIR"。

<!-- truncate -->

**💡 [在Twitter查看本期简报](https://slo.im/thread) - 可视化排版 🎨**

---

import Support from "../_support.mdx";

<Support />

---

## 💸 赞助商 {#sponsor1}

[![轻松实现应用内订阅](/emails/issues/177/revenuecat.jpg)](https://www.revenuecat.com?utm_source=twir&utm_medium=sponsorship&utm_campaign=dec_23)

**[轻松实现应用内订阅](https://www.revenuecat.com?utm_source=twir&utm_medium=sponsorship&utm_campaign=dec_23)**

RevenueCat为您提供变现、分析和增长业务所需的一切工具。轻松管理用户权限与订阅、控制数据、进行定价实验。超过30,000款应用选择信任RevenueCat来支撑其应用内购买基础设施。

---

## ⚛️ React {#react}

[![使用useDeferredValue优化UI响应速度](/emails/issues/185/useDeferredValue.jpg)](https://www.joshwcomeau.com/react/use-deferred-value/)

**[使用useDeferredValue优化UI响应速度](https://www.joshwcomeau.com/react/use-deferred-value/)**

Josh Comeau带来一篇精彩博文，展示了`useDeferredValue()`钩子的实用价值——通过将昂贵组件的渲染降级为低优先级任务，实现对并发React的按需启用。他用实际遇到的性能问题为例，演示该钩子如何有效解决问题。要实现最佳效果，需要用`memo()`包裹昂贵组件。文中的交互式时间轴能帮助理解这与节流机制的本质差异。

---

[![为什么选择React Query？](/emails/issues/185/reactquery.jpg)](https://ui.dev/why-react-query)

**[为什么选择React Query？](https://ui.dev/why-react-query)**

Dominik Dorfmeister在推出官方React Query课程之际，免费发布了第一课。这篇交互式文章循序渐进地展示了React Query的全套能力，包括处理竞态条件、请求去重和缓存机制。它更像一个"异步状态管理器"而非简单的数据请求库。即使您不使用React Query，这也是一篇值得所有React开发者阅读的深度好文。

---

- 💸 [NLUX ― 新增React库用于集成AI功能](https://nlux.dev/?utm_source=twir-m24)
- 📖 [React文档 - StrictMode - 通过开发环境重新执行ref回调来修复错误](https://19.react.dev/reference/react/StrictMode#fixing-bugs-found-by-re-running-ref-callbacks-in-development): 上周我提到React 19 StrictMode中ref会触发两次。这是有充分理由的，这个新文档章节解释了它如何防止错误，特别是在处理ref列表时。
- 📖 [React文档 - 不要使用ref阻止Effect触发](https://react.dev/learn/synchronizing-with-effects#dont-use-refs-to-prevent-effects-from-firing)
- 👀 [Next.js PR - unstable_after](http://next.js): 这个即将推出的功能允许用户在请求结束后调度回调执行。这需要运行时支持waitUntil函数，[Vercel刚刚发布](https://vercel.com/changelog/waituntil-is-now-available-for-vercel-functions)了这个功能（Cloudflare已支持）。对于不延迟响应的日志记录/分析特别有用。
- 🐦 [实验性Node.moveBefore() API - 跨元素移动和重新父级化时保留DOM状态](https://twitter.com/domfarolino/status/1790407887740666335): 一个很棒的新API可能登陆Web平台，允许React将JSX节点重新父级化到不同位置而不重置DOM状态（参见[Sebastian Markbåge的评论](https://github.com/whatwg/dom/issues/1255#issuecomment-2021486232)）。
- 🗓 [React峰会](https://reactsummit.com/?utm_source=thisweekinreact) - 🇳🇱 阿姆斯特丹 - 6月14-18日 - 在售罄前购票。使用代码"TWIR"可享9折优惠。
- 🗓 [dotJS](https://www.dotjs.io/?utm_source=thisweekinreact) - 🇫🇷 巴黎 - 6月27日 - Malte Ubl、Jessica Sachs、James Q Quick等国际演讲者将出席！使用代码"TWIR"可享9折优惠
- 📜 [用400行代码构建你自己的React.js](https://webdeveloper.beehiiv.com/p/build-react-400-lines-code): 作者构建了一个"迷你React"，能够运行官方React井字棋教程，仅400行代码，支持Fiber/中断。他解释了一些主要算法
- 📜 [React服务器组件(RSCs)的深入解析](https://www.smashingmagazine.com/2024/05/forensics-react-server-components/): 深入探讨RSCs、Suspense、流式传输、懒加载，包含许多有用的图表、带注释的截图和负载示例。重点关注性能和用户体验影响。
- 📜 [不只是你，Next.js正变得越来越难用](https://www.propelauth.com/post/nextjs-challenges): 认为随着App Router的引入，Next.js变得更加微妙和难以使用。通过激进的缓存和无法在RSCs中获取当前路径名来说明。
- 📜 [使用Framer Motion为Radix Primitives添加动画](https://sinja.io/blog/animating-radix-primitives-with-framer-motion): 退出动画处理起来更棘手，需要以受控方式使用Radix并结合"forceMount"属性。
- 📜 [React开发者学习SolidJS指南](https://www.stashpad.com/blog/react-developer-guide-to-solid-js): 很好地解释了两个库的代码看起来相似，但工作原理根本不同，这可能会误导你。
- 📜 [使用TanStack Query预取数据](https://tigerabrodi.blog/prefetching-data-with-tanstack-query): 在带有"下一篇"导航链接的博客上，可以预取下一篇的React Query数据，使导航更快。
- 📜 [React、Electron和LLMs的共同目的：开发工具流行度的劳动力套利理论](https://www.baldurbjarnason.com/2024/react-electron-llms-labour-arbitrage/): 有趣的观点认为使用React等流行技术的开发者是商品，管理层更看重这个而非技术进步🤷‍♂️。
- 📜 [从RSC迁移到SolidStart](https://www.brenelz.com/posts/moving-from-rsc-to-solid-start)
- 📜 [RedwoodJS中的中间件](https://redwoodjs.com/blog/middleware-in-redwoodjs) + [新功能：og:image中间件](https://redwoodjs.com/blog/new-feature-ogimage-middleware)
- 📜 [Apollo Client - 优化数据获取，利用useFragment和共置片段](https://www.apollographql.com/blog/optimizing-data-fetching-with-apollo-client-leveraging-usefragment-and-colocated-fragments)
- 📜 [如何将Stripe与React集成？](https://scientyficworld.org/how-to-integrate-stripe-with-react/)
- 📜 [使用React实现拖放。用Playwright编写端到端测试](https://wanago.io/2024/05/06/react-drag-drop-e2e-playwright/)
- 📜 [使用React实现无限滚动。用Playwright编写端到端测试](https://wanago.io/2024/04/29/react-infinite-scrolling-e2e-playwright/)
- 📦 [Astro 4.8 - Astro Actions, 请求重写](https://astro.build/blog/astro-480/): Astro新增实验性功能，包括调用类型安全的服务器函数，使用Zod验证JSON或FormData，并支持渐进增强。
- 📦 [Pigment CSS 0.0.10](https://github.com/mui/pigment-css/releases/tag/v0.0.10): 新的零运行时CSS-in-JS库持续进步(🐦 [93%的MUI组件现在支持CSS提取](https://twitter.com/siriwatknp/status/1788061040544194836))
- 📦 [MDXTS 1.0 - 使用MDX、TypeScript和React构建内容和文档库的新工具](https://www.mdxts.dev/blog/introducing-mdxts)
- 🕹 [Athena Crisis现已开源](https://cpojer.net/posts/athena-crisis-open-source): Christoph Nakazawa(Jest、Metro...)创建了一款完整的复古独立游戏，已在Steam上线。React-DOM代码库现已开源，为贡献者提供赏金。
- 🎥 [Theo - 这个版本让我想离开React](https://www.youtube.com/watch?v=aOk67eT3fpg): Phoenix LiveView [1.0 RC已发布](https://www.phoenixframework.org/blog/phoenix-liveview-1.0-released)，以有趣的方式解决了与React服务器组件类似的问题。通过保持与服务器的WebSocket连接，可以实时向客户端发送更新。注意今天晚些时候React Conf有个关于这个话题的精彩演讲：实时服务器组件。
- 🎥 [React Conf - YouTube直播](https://www.youtube.com/watch?v=T8TZQ6k4SLE)

<SubscribeFormEmbed placement="middle" />

---

## 💸 赞助商 {#sponsor2}

[![Refine - 开源版Retool替代方案](/emails/issues/177/refine.jpg)](https://github.com/refinedev/refine)

**[Refine - 开源版Retool替代方案](https://github.com/refinedev/refine)**

专为CRUD密集型应用打造，在低代码与传统开发之间取得完美平衡。

作为面向企业级应用的开源React元框架，[Refine](https://github.com/refinedev/refine) 提供无头解决方案，非常适合开发管理后台、仪表盘和内部工具。

低代码工具虽初期见效快，但在处理复杂场景时往往因扩展性不足、定制选项有限和供应商锁定风险而捉襟见肘。

Refine让团队既能快速构建生产级应用，又能保持架构灵活性。

---

## 📱 React-Native {#react-native}

本节由 [Benedikt](https://twitter.com/bndkt) 执笔。

- 💸 [React Native 分析工具 — 通过 Omlet 即时测量组件使用情况。利用预构建和自定义图表的数据来优化代码库](https://omlet.dev/?utm_campaign=partner_this-week-in-react_newsletter-rn-ql-may-2024)
- 🐦 [React Native Community CLI 中的依赖自动链接功能大幅提速](https://x.com/SzymonRybczak/status/1788520827232584008)
- 🐦 [App Store 商业应用 Top 100 中，26 款基于 React Native 开发，3 款使用 Flutter，8 款采用 Cordova](https://x.com/Baconbrix/status/1790095033472802858)
- 🐦 [React Native 版"非热狗"识别应用](https://x.com/mrousavy/status/1788895681320522048)：展示 Vision Camera 帧处理器的巧妙案例
- 👀 [Hermes 现已支持 visionOS](https://github.com/facebook/hermes/pull/1358)
- 🗓 [App.js 大会](https://appjs.co/?utm_source=thisweekinreact) - 🇵🇱 克拉科夫 - 5月22-24日。使用优惠码"TWIR"可享[9折优惠](https://ti.to/appjs/2024/discount/TWIR)
- 📜 [使用 RN Skia 在 React Native 中实现刮刮卡效果](https://javascript.plainenglish.io/creating-a-scratch-card-in-react-native-using-react-native-skia-23332bd32942)：包含 Skia、Reanimated 和手势处理的完整教程
- 📜 [在 Monorepo 中搭建 React Native Web 项目](https://unicorn-utterances.com/posts/react-native-web-monorepo)：这个教程的实际价值远超标题所示，配置过程还涉及 Vite 和 Styled Components
- 📜 [处理缓慢重渲染：利用 React DevTools 和 JavaScript Profiler 的非常规解决方案](https://www.bam.tech/article/handle-slow-re-renders-a-not-so-obvious-solution-using-react-devtools-and-javascript-profiler)：性能优化是极具价值但不易掌握的技能，本文详细介绍了开发工具和性能分析器的使用
- 📜 [破除混合开发框架的认知误区](https://www.bam.tech/article/debunk-ideas-on-hybrid-framework)：作为 RN 开发者，你应当了解这些内容。当遇到对 RN 仍有常见误解的人时，本文堪称理想的书签资料
- 📜 [React Native 新架构性能基准测试概览](https://dev.to/yoel/react-native-new-architecture-what-you-need-to-know-1eke)：涵盖新架构和去桥接模式的介绍，以及原生模块和 Fabric 渲染视图模块的性能测试。基准测试代码已在 GitHub 开源
- 📜 [React Native 中关闭键盘的正确姿势](https://www.bam.tech/article/dismissing-keyboard-in-react-native-stop-the-struggle)
- 📦 [React-Native-Model3d - 在 visionOS 应用中渲染 3D 模型](https://github.com/okwasniewski/react-native-model3d)
- 📦 [Re.Pack 4.0 - React Native 版 Webpack - 支持新架构，兼容 Metro 模块解析](https://github.com/callstack/repack/releases/tag/%40callstack%2Frepack%404.0.0)
- 📦 [React Native Video 6.0 - 支持 TypeScript、RN 0.73、通知控件、字幕样式、全屏模式](https://github.com/TheWidlarzGroup/react-native-video/releases/tag/v6.0.0)
- 🎙️ [火箭飞船第40期 - 与 Kitze 探讨从 Next.js 转向 React Native](https://share.transistor.fm/s/47610b15)
- 🎙️ [React Native 播客第37期 - Catalin Miron 谈高性能动画开发](https://www.youtube.com/watch?v=1XWmlgTYJ6k)
- 🎥 [React Native 优化短片 - Flashlist 真的优于默认方案吗？](https://www.youtube.com/watch?v=2FfU-PIDN2U)
- 🎥 [Simon Grimm - Expo SDK 51：新功能包、路由、架构与模板](https://www.youtube.com/watch?v=wqS8LqRhNVY)

---

## 🔀 其他 {#other}

- 👀 [CSS RFC - CSS 层级分类标准 - CSS4 与 CSS5](https://github.com/CSS-Next/css-next/discussions/92)
- 📊 [2023年HTML现状调查报告结果公布](https://2023.stateofhtml.com/)
- 📜 [CSS锚点定位API正式介绍](https://developer.chrome.com/blog/anchor-positioning-api)
- 📦 [Chrome 125新特性 - CSS锚点定位、Compute Pressure API](https://developer.chrome.com/blog/new-in-chrome-125)
- 📦 [Safari 17.5的WebKit新功能 - text-wrap: balance, light-dark(), @starting-style](https://webkit.org/blog/15383/webkit-features-in-safari-17-5/)
- 📦 [esbuild 0.21发布 - 支持装饰器语法](https://github.com/evanw/esbuild/releases/tag/v0.21.0)
- 📦 [类型复杂度追踪器 - 用于测量项目内类型复杂度的VSCode插件](https://github.com/tsperf/tracer)
- 📦 [Oslo - 面向全JS生态的轻量级认证工具包](https://oslojs.dev)
- 🗓 [GraphQLConf大会 - 旧金山，9月10-12日 - 征稿截止至5月22日](https://graphql.org/conf/2024/?utm_source=thisweekinreact)

---

## 🤭 轻松一刻 {#fun}

[![alt](/emails/issues/185/meme.jpg)](https://twitter.com/sebastienlorber/status/1788682484541952418)

[![alt](/emails/issues/185/meme2.jpg)](https://twitter.com/vincentriemer/status/1790447746987495818)

下期见！👋