---
slug: /185
title: "This Week In React #185: React Conf, useDeferredValue, React Query, refs, Next.js after, mini-react, Astro, MDXTS, Radix, Solid, Redwood, Pigment, Apollo, Playwright, Re.Pack, RN-Model3D, RN perf, RN Video, VisionOS, LiveView, Anchor Positioning ..."
authors: [slorber, bndkt]
date: 05-15-2024
---

大家好！

本周的版本更新相对平静（至少目前如此）！我们收获了不少优质的React技术文章，但也不乏批评之声，甚至有些内容在推荐替代方案（如Solid、Phoenix LiveView）😅。

React Conf今天晚些时候就要开幕了！我们期待会上公布的重要内容，下周会为大家详细报道。今天特意提前发送简报，这样我就能毫无压力地观看直播了😄。

[React Conf YouTube直播链接](https://www.youtube.com/watch?v=T8TZQ6k4SLE)已开放。查看[会议议程](https://conf.react.dev/agenda)后，我们特别期待以下演讲：

- React与React Native主题演讲及问答环节
- Expo Router中的通用React服务端组件 - Evan Bacon（Expo）
- 实时服务端组件 - Sunil Pai（PartyKit）
- 用React构建空间计算应用 - Michał Pierzchała（Callstack）
- 跨平台React开发 - Olga Zinoveva与Naman Goel（Meta）

说到技术会议，美国React Native大会[**Chain React**](https://chainreactconf.com/?utm_source=thisweekinreact)将于7月17-19日回归（波特兰/俄勒冈州）。我们合作提供15%门票折扣，优惠码"TWIR"。

<!-- truncate -->

**💡 [在Twitter查看本期简报](https://slo.im/thread) - 视觉化排版 🎨**

---

import Support from "../_support.mdx";

<Support />

---

## 💸 赞助商 {#sponsor1}

[![应用内订阅一站式解决方案](/emails/issues/177/revenuecat.jpg)](https://www.revenuecat.com?utm_source=twir&utm_medium=sponsorship&utm_campaign=dec_23)

**[应用内订阅一站式解决方案](https://www.revenuecat.com?utm_source=twir&utm_medium=sponsorship&utm_campaign=dec_23)**

RevenueCat提供应用商业化所需的完整工具链，涵盖权限管理、数据分析与业务增长。轻松控制用户访问权限，管理数据，并实施定价实验。已有超过30,000款应用选择RevenueCat作为应用内购基础设施。

---

## ⚛️ React {#react}

[![使用useDeferredValue实现流畅UI优化](/emails/issues/185/useDeferredValue.jpg)](https://www.joshwcomeau.com/react/use-deferred-value/)

**[使用useDeferredValue实现流畅UI优化](https://www.joshwcomeau.com/react/use-deferred-value/)**

Josh Comeau带来一篇精彩博文，展示了`useDeferredValue()`钩子的实用价值——该钩子允许通过将昂贵组件的渲染降级为低优先级任务来启用并发模式。他通过实际遇到的性能问题，演示了该钩子如何有效解决问题。要实现最佳效果，需用`memo()`包裹昂贵组件。文中的交互式时间轴有助于理解其与节流机制的本质差异。

---

[![为什么选择React Query？](/emails/issues/185/reactquery.jpg)](https://ui.dev/why-react-query)

**[为什么选择React Query？](https://ui.dev/why-react-query)**

Dominik Dorfmeister在发布官方React Query课程之际，免费开放了第一课内容。这篇交互式文章循序渐进地展示了React Query的全套功能，包括竞态处理、请求去重和缓存机制。它远不止是数据请求库，更像是"异步状态管理器"。即使不使用React Query，也值得所有React开发者阅读。

---

- 💸 [NLUX ― 新增React库用于集成AI功能](https://nlux.dev/?utm_source=twir-m24)
- 📖 [React文档 - StrictMode - 通过重新运行ref回调函数修复开发环境下的bug](https://19.react.dev/reference/react/StrictMode#fixing-bugs-found-by-re-running-ref-callbacks-in-development): 上周我提到React 19 StrictMode中ref会触发两次。这是有充分理由的，这份新文档解释了该机制如何预防bug，特别是处理ref列表时。
- 📖 [React文档 - 不要使用ref阻止Effect触发](https://react.dev/learn/synchronizing-with-effects#dont-use-refs-to-prevent-effects-from-firing)
- 👀 [Next.js PR - unstable_after](http://next.js): 这个即将推出的功能允许用户在当前请求结束后调度回调函数执行。这需要运行时支持waitUntil函数，[Vercel刚实现该功能](https://vercel.com/changelog/waituntil-is-now-available-for-vercel-functions)（Cloudflare早已支持）。特别适用于日志记录/分析场景且不延迟响应。
- 🐦 [实验性Node.moveBefore() API - 保持DOM状态在元素移动和重新父级化时的连续性](https://twitter.com/domfarolino/status/1790407887740666335): 一个令人振奋的新Web平台API可能落地，允许React在不同位置重新挂载JSX节点而不重置DOM状态（参见[Sebastian Markbåge的评论](https://github.com/whatwg/dom/issues/1255#issuecomment-2021486232)）。
- 🗓 [React峰会](https://reactsummit.com/?utm_source=thisweekinreact) - 🇳🇱 阿姆斯特丹 - 6月14-18日 - 门票售罄前抓紧购买。使用代码"TWIR"可享9折优惠。
- 🗓 [dotJS](https://www.dotjs.io/?utm_source=thisweekinreact) - 🇫🇷 巴黎 - 6月27日 - Malte Ubl、Jessica Sachs、James Q Quick等国际演讲者将出席！使用代码"TWIR"可享9折优惠
- 📜 [400行代码实现你自己的React.js](https://webdeveloper.beehiiv.com/p/build-react-400-lines-code): 作者用400行代码构建了能运行官方React井字棋教程的"迷你React"，支持Fiber/中断机制。文中解释了一些核心算法
- 📜 [React服务端组件(RSCs)技术内幕](https://www.smashingmagazine.com/2024/05/forensics-react-server-components/): 深度剖析RSCs、Suspense、流式传输和懒加载，包含大量示意图、带注释截图和载荷示例。重点关注性能和用户体验影响。
- 📜 [并非你的错觉，Next.js正变得越来越难用](https://www.propelauth.com/post/nextjs-challenges): 论证App Router使Next.js变得更隐晦难用，举例说明激进缓存问题和RSC中无法获取当前路径名的限制。
- 📜 [用Framer Motion为Radix Primitives添加动画](https://sinja.io/blog/animating-radix-primitives-with-framer-motion): 退出动画处理更复杂，需要以受控方式使用Radix并配合"forceMount"属性。
- 📜 [React开发者学习SolidJS指南](https://www.stashpad.com/blog/react-developer-guide-to-solid-js): 精彩阐述两个库代码相似但底层原理迥异，这种差异可能导致认知误区。
- 📜 [使用TanStack Query预取数据](https://tigerabrodi.blog/prefetching-data-with-tanstack-query): 在博客的"下一篇"导航链接中预取React Query数据可加速页面切换。
- 📜 [React、Electron和LLMs的共同点：开发工具流行度的劳动力套利理论](https://www.baldurbjarnason.com/2024/react-electron-llms-labour-arbitrage/): 有趣观点认为使用React等流行技术的开发者已成为商品，管理层更看重这点而非技术进步🤷‍♂️。
- 📜 [从RSC迁移到SolidStart](https://www.brenelz.com/posts/moving-from-rsc-to-solid-start)
- 📜 [RedwoodJS中的中间件](https://redwoodjs.com/blog/middleware-in-redwoodjs) + [新功能：og:image中间件](https://redwoodjs.com/blog/new-feature-ogimage-middleware)
- 📜 [Apollo Client优化数据获取：利用useFragment和并置片段](https://www.apollographql.com/blog/optimizing-data-fetching-with-apollo-client-leveraging-usefragment-and-colocated-fragments)
- 📜 [如何在React中集成Stripe支付？](https://scientyficworld.org/how-to-integrate-stripe-with-react/)
- 📜 [React拖拽功能实现：使用Playwright编写端到端测试](https://wanago.io/2024/05/06/react-drag-drop-e2e-playwright/)
- 📜 [React无限滚动实现：使用Playwright进行端到端测试](https://wanago.io/2024/04/29/react-infinite-scrolling-e2e-playwright/)
- 📦 [Astro 4.8 - Astro Actions、请求重写](https://astro.build/blog/astro-480/): 新增实验性功能，包括调用类型安全的服务端函数（通过Zod验证JSON或FormData）并支持渐进增强。
- 📦 [Pigment CSS 0.0.10](https://github.com/mui/pigment-css/releases/tag/v0.0.10): 新兴零运行时CSS-in-JS库持续进步（🐦 [93%的MUI组件已支持CSS提取](https://twitter.com/siriwatknp/status/1788061040544194836)）
- 📦 [MDXTS 1.0 - 使用MDX、TypeScript和React构建内容及文档的新工具](https://www.mdxts.dev/blog/introducing-mdxts)
- 🕹 [Athena Crisis现已开源](https://cpojer.net/posts/athena-crisis-open-source): Christoph Nakazawa（Jest、Metro开发者）制作的复古独立游戏已在Steam发布。React-DOM代码库现已开源并提供贡献者奖励。
- 🎥 [Theo - 这个版本让我想放弃React](https://www.youtube.com/watch?v=aOk67eT3fpg): Phoenix LiveView [1.0候选版发布](https://www.phoenixframework.org/blog/phoenix-liveview-1.0-released)，以有趣方式解决了类似React服务端组件的问题。通过保持与服务器的WebSocket连接实现实时更新。注意今天React Conf有相关演讲：实时服务端组件。
- 🎥 [React Conf - YouTube直播](https://www.youtube.com/watch?v=T8TZQ6k4SLE)

<SubscribeFormEmbed placement="middle" />

---

## 💸 赞助商 {#sponsor2}

[![Refine - 开源版Retool替代方案](/emails/issues/177/refine.jpg)](https://github.com/refinedev/refine)

**[Refine - 开源版Retool替代方案](https://github.com/refinedev/refine)**

专为CRUD密集型应用打造的低代码与传统开发完美平衡方案。

作为面向企业级应用的开源React元框架，[Refine](https://github.com/refinedev/refine) 提供无头(headless)解决方案，特别适合开发管理后台、仪表盘和内部工具。

低代码工具虽初期便捷，但在处理复杂场景时常因扩展性不足、定制受限和供应商锁定问题而捉襟见肘。

Refine让团队既能快速构建生产级应用，又能保持技术灵活性。

---

## 📱 React-Native {#react-native}

本版块由 [Benedikt](https://twitter.com/bndkt) 主笔。

- 💸 [React Native 分析工具 — 通过 Omlet 即时测量组件使用情况。利用预构建和自定义图表的数据来优化代码库](https://omlet.dev/?utm_campaign=partner_this-week-in-react_newsletter-rn-ql-may-2024)
- 🐦 [React Native Community CLI 中的依赖自动链接功能大幅提速](https://x.com/SzymonRybczak/status/1788520827232584008)
- 🐦 [App Store 商业应用 Top 100 中，26 款基于 React Native 构建，3 款使用 Flutter，8 款采用 Cordova](https://x.com/Baconbrix/status/1790095033472802858)
- 🐦 [React Native 实现的"非热狗"检测应用](https://x.com/mrousavy/status/1788895681320522048)：展示 Vision Camera 帧处理器的巧妙案例
- 👀 [Hermes 现已支持 visionOS](https://github.com/facebook/hermes/pull/1358)
- 🗓 [App.js 大会](https://appjs.co/?utm_source=thisweekinreact) - 🇵🇱 克拉科夫 - 5月22-24日。使用代码"TWIR"可享[9折优惠](https://ti.to/appjs/2024/discount/TWIR)
- 📜 [使用 RN Skia 在 React Native 中实现刮刮卡效果](https://javascript.plainenglish.io/creating-a-scratch-card-in-react-native-using-react-native-skia-23332bd32942)：包含 Skia、Reanimated 和手势处理的教程
- 📜 [在 Monorepo 中搭建 React Native Web 项目](https://unicorn-utterances.com/posts/react-native-web-monorepo)：这个教程比标题更有料，配置还涉及 Vite 和 Styled Components
- 📜 [处理缓慢重渲染：利用 React DevTools 和 JavaScript Profiler 的非常规解决方案](https://www.bam.tech/article/handle-slow-re-renders-a-not-so-obvious-solution-using-react-devtools-and-javascript-profiler)：性能优化是宝贵但不易掌握的技能，这是使用开发工具和性能分析器的详细指南
- 📜 [破除混合框架的认知误区](https://www.bam.tech/article/debunk-ideas-on-hybrid-framework)：作为 RN 开发者你应已了解这些，但这是份应对常见误解的实用书签
- 📜 [React Native 新架构性能基准测试概览](https://dev.to/yoel/react-native-new-architecture-what-you-need-to-know-1eke)：涵盖新架构和去桥接模式，附带原生模块和 Fabric 渲染视图的性能测试，代码已开源
- 📜 [React Native 中关闭键盘的正确姿势](https://www.bam.tech/article/dismissing-keyboard-in-react-native-stop-the-struggle)
- 📦 [React-Native-Model3d - 在 visionOS 应用中渲染 3D 模型](https://github.com/okwasniewski/react-native-model3d)
- 📦 [Re.Pack 4.0 - React Native 的 Webpack 工具 - 支持新架构，兼容 Metro 模块解析](https://github.com/callstack/repack/releases/tag/%40callstack%2Frepack%404.0.0)
- 📦 [React Native Video 6.0 - TypeScript 支持，RN 0.73 适配，通知控制，字幕样式，全屏功能](https://github.com/TheWidlarzGroup/react-native-video/releases/tag/v6.0.0)
- 🎙️ [火箭飞船第40期 - 与 Kitze 探讨从 Next.js 转向 React Native](https://share.transistor.fm/s/47610b15)
- 🎙️ [React Native 播客第37期 - Catalin Miron 谈高性能动画开发](https://www.youtube.com/watch?v=1XWmlgTYJ6k)
- 🎥 [React Native 优化短片 - Flashlist 真的比默认方案更优吗？](https://www.youtube.com/watch?v=2FfU-PIDN2U)
- 🎥 [Simon Grimm - Expo SDK 51：新包、路由、架构与模板](https://www.youtube.com/watch?v=wqS8LqRhNVY)

---

## 🔀 其他动态 {#other}

- 👀 [CSS RFC - CSS层级分类标准讨论（CSS4 & CSS5）](https://github.com/CSS-Next/css-next/discussions/92)
- 📊 [2023年HTML现状调查报告结果公布](https://2023.stateofhtml.com/)
- 📜 [CSS锚点定位API正式介绍](https://developer.chrome.com/blog/anchor-positioning-api)
- 📦 [Chrome 125新特性 - CSS锚点定位、计算压力API](https://developer.chrome.com/blog/new-in-chrome-125)
- 📦 [Safari 17.5的WebKit新特性 - text-wrap: balance平衡换行、light-dark()主题切换、@starting-style初始样式](https://webkit.org/blog/15383/webkit-features-in-safari-17-5/)
- 📦 [esbuild 0.21发布 - 装饰器语法支持](https://github.com/evanw/esbuild/releases/tag/v0.21.0)
- 📦 [类型复杂度追踪器 - 用于测量项目内类型复杂度的VSCode插件](https://github.com/tsperf/tracer)
- 📦 [Oslo - 面向全JS生态的轻量级认证工具包](https://oslojs.dev)
- 🗓 [GraphQLConf大会 - 旧金山9月10-12日 - 征稿截止至5月22日](https://graphql.org/conf/2024/?utm_source=thisweekinreact)

---

## 🤭 趣味时刻 {#fun}

[![alt](/emails/issues/185/meme.jpg)](https://twitter.com/sebastienlorber/status/1788682484541952418)

[![alt](/emails/issues/185/meme2.jpg)](https://twitter.com/vincentriemer/status/1790447746987495818)

下期见！👋