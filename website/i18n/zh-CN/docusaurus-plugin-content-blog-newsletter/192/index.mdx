---
slug: /192
title: "This Week In React #192: Fog of War, react-html, Memory leaks, Suspense, security, chadcn/ui Charts, MUI, XR, Filament, Rise, Expo, React Navigation, Reanimated, Node, TypeScript, pnpm, Vitest..."
authors: [slorber]
date: 07-18-2024
---

大家好！

经过两周的休整后，本通讯正式回归！

本期将涵盖三周的资讯，由于内容过多难以通过单封邮件承载，我不得不进行更严格的筛选。尽管正值假期，React社区仍涌现了大量优质文章，React Native领域也有不少值得关注的动态！

若您钟爱本通讯的全面性，建议您查阅[在线版](https://thisweekinreact.com/newsletter/192)——本期特别收录了额外章节，包含两倍于邮件的精选链接。这也侧面体现了我的工作价值：您未看到的内容，正是我海量阅读筛选后忍痛割爱的部分。

欢迎关注合作会议[React-Brussels](https://www.react.brussels/?utm_source=thisweekinreact)（🇧🇪布鲁塞尔·10月18日），使用代码"TWIR"可享9折优惠，首批演讲嘉宾已公布！

<!-- truncate -->

**💡 [在Twitter查看本期通讯](https://slo.im/thread) - 视觉化排版 🎨**

---

import Support from "../_support.mdx";

<Support />

---

## 💸 赞助商 {#sponsor1}

[![企业级React数据网格的品类定义者](/emails/issues/190/advertfinal.jpg)](https://1771technologies.com/graphitegrid)

**[企业级React数据网格的品类定义者](https://1771technologies.com/graphitegrid)**

数据网格是Web应用中的复杂组件，但现有解决方案效率低下、维护成本高且性能不佳。[Graphite Grid](https://1771technologies.com/graphitegrid)通过两大核心特性改变格局：可重定向渲染与响应式信号状态。

**Graphite Grid**将网格状态与视图逻辑分离，允许单一状态模型支持多种渲染目标（声明式或命令式）。内置**DOM与Canvas**渲染器，为开发者提供灵活的高性能选择🚀。

该产品采用声明式设计，通过状态信号确保与应用无缝集成。作为**专为React打造**的解决方案，这是唯一基于React状态管理原语构建的JavaScript数据网格。[立即体验！](https://1771technologies.com/graphitegrid/demo)

---

## ⚛️ React动态 {#react}

[![Remix - 战争迷雾](/emails/issues/192/rr.jpg)](https://remix.run/blog/fog-of-war)

**[Remix - 战争迷雾](https://remix.run/blog/fog-of-war)**

上期已简要提及该特性，现通过专文详解其原理。React Router新功能支持将路由清单分块加载。本文阐述Remix 2.10如何集成该特性及其权衡考量——未分块的路由清单可能因体积过大延迟React水合过程。中大型Remix/React Router站点建议立即检查路由清单体积，并规划合理的分块策略：Shopify的清单从10MB降至1.9KB！Docusaurus官网的200KB清单也亟待优化。

---

- 💸 [Meilisearch — 用React构建快速、容错的搜索功能](https://dub.sh/0PeE0RQ)
- 👀 [React核心PR - `ReactHTML.renderToMarkup`](https://github.com/facebook/react/pull/30105): 正在引入新的`react-html`包，用于生成无需水化的HTML（如电子邮件）。它是`renderToStaticMarkup`的继任者，支持Suspense等现代特性。
- 👀 [React核心PR - `React.captureOwnerStack()`](http://github.com/facebook/react/pull/29923): 从众多PR可见，React仓库正投入大量精力改进调试、日志记录和生成可读的"组件所有者堆栈跟踪"。这个新公共API将帮助框架开发者显示错误对话框。
- 👀 [Next.js PR - TypeScript配置文件(`next.config.ts`)](https://github.com/vercel/next.js/pull/63051): 配置文件中获得一流的TypeScript支持（不再局限于JSDoc注释），这对开发者体验是重大改进。
- 🗓️ [React Rally](https://reactrally.com/?utm_source=thisweekinreact) - 🇺🇸 犹他州 - 8月12-13日 - 使用代码"TWIR"可享[9折优惠](https://ti.to/react-rally/react-rally-2024/discount/TWIR)。阵容包括Kent C. Dodds、Cory House等大咖。
- 📜 [React内存泄漏陷阱：为什么编译器救不了你](http://schiener.io/2024-07-07/react-closures-compiler): 关于React内存泄漏的三部曲终章。作者发现使用React编译器反而会引入原本不存在的内存泄漏，使用bind可能是可行方案。需注意这类内存问题源于JS函数式编程特性，并非React独有。
- 📜 [用TypeScript命名空间简化组件导入](https://sergiodxa.com/tutorials/simplify-component-imports-with-typescript-namespaces): 这个React+TypeScript技巧获得[Matt Pocock认可](https://x.com/mattpocockuk/status/1805606072167940167)。
- 📜 [如何防范React服务端组件的安全漏洞](https://www.nodejs-security.com/blog/how-to-protect-against-a-security-breach-in-react-server-components): 强调仅用Zod验证不够，必须检查服务端动作输入的访问控制。
- 📜 [WorkOS - 零停机迁移至Next.js App Router](https://workos.com/blog/migrating-to-next-js-app-router-with-zero-downtime): 通过查询参数实现Pages Router与App Router双模式切换的巧妙方案。
- 📜 [纽约时报用React 18提升Web性能](https://open.nytimes.com/enhancing-the-new-york-times-web-performance-with-react-18-d6f91a7c5af8): 从React 16迁移后获得更少重渲染和INP分数提升，但也遇到更严格的水合要求。
- 📜 [通过构建支持Suspense的库来学习Suspense](https://www.bbss.dev/posts/react-learn-suspense/): 通过实现`useFetch()`钩子演示现实库的工作原理。
- 📜 [关于按钮的一切](https://blog.jim-nielsen.com/2024/all-about-that-button/): Remix提倡声明式HTML实现渐进增强的按钮交互。
- 📜 [自托管Next.js的秘诀](https://www.flightcontrol.dev/blog/secret-knowledge-to-self-host-nextjs): 在非Vercel环境部署生产级Next.js的完整指南。
- 📜 [关于React服务端组件的5个误解](https://www.builder.io/blog/nextjs-react-server-components)
- 📦 [chadcn/ui图表 - 基于Recharts构建的优雅图表组件集](https://ui.shadcn.com/docs/components/chart)
- 📦 [Material UI 6.0测试版 - 可选Pigment CSS运行时方案/容器查询](https://next.mui.com/material-ui/migration/migrating-to-v6/)
- 📦 [react-three/xr 6.0 - react-three-fiber的AR/VR方案](https://github.com/pmndrs/xr)
- 📦 [Motion-Primitives - 基于Framer Motion设计的动效组件](https://motion-primitives.com/)
- 🎥 [Jack Herrington - 警告：React 19的use钩子可能影响性能](https://www.youtube.com/watch?v=t6MeFVF3V9I): 揭示首次遇到"use"钩子时的React实现细节。
- 🎙️ [PodRocket - 与React编译器团队对话](https://podrocket.logrocket.com/react-compiler-sathya-gunasekaran-joe-savona)

**扩展阅读：**

- 👀 [Next.js PR - instrumentation.js中的onRequestError](https://github.com/vercel/next.js/pull/67539)
- 💬 [为什么Vercel选择开发Turbopack而非使用Vite](https://github.com/vercel/next.js/issues/48748#issuecomment-2199941311)
- 📜 [可维护Remix应用的秘诀：六边形架构](https://laconicwit.com/the-secret-to-maintainable-remix-apps-hexagonal-architecture/)
- 📜 [你能修改React的Props吗？](https://www.epicreact.dev/can-you-modify-react-props)
- 📜 [揭秘Next.js中的缓存机制](https://www.nico.fyi/blog/demistifying-cache-in-nextjs)
- 📜 [Tanstack Query能节省多少代码量](https://www.frontendundefined.com/posts/monthly/tanstack-query-savings/)
- 📜 [在Cloudflare上部署Next.js应用的实际体验](https://davidgomes.com/the-experience-of-deploying-next-js-apps-on-cloudflare/)
- 📜 [为React 19做准备：WordPress 6.6用户指南](https://kinsta.com/blog/react-19-wordpress/)
- 📜 [在现有Rails应用中集成React的实用指南（同时保留Hotwire）](https://thoughtbot.com/blog/add-react-to-an-existing-rails-app)
- 📜 [Next.js与缓存投毒：寻找黑洞的探索](https://zhero-web-sec.github.io/research-and-things/nextjs-and-cache-poisoning-a-quest-for-the-black-hole)
- 📜 [Docker自托管Next.js的安全建议](https://blog.arcjet.com/security-advice-for-self-hosting-next-js-in-docker/)
- 📜 [使用Conform处理表单数据中的嵌套数组和对象](https://www.jacobparis.com/content/conform-nested-formdata)
- 📜 [React表单按钮实践](https://www.robinwieruch.de/react-form-button/)
- 📜 [React表单中为Server Actions添加额外参数](https://www.robinwieruch.de/react-form-server-action-extra-arguments/)
- 📜 [Next.js中实现loader模式的createPage辅助函数](https://saas-ui.dev/blog/nextjs-create-page-helper-with-loader-pattern)
- 📜 [Zustand状态库的诞生故事](https://blog.axlight.com/posts/how-zustand-was-born/)
- 📜 [React useRef钩子：不仅适用于DOM元素](https://opensauced.pizza/docs/community-resources/the-react-useref-hook-not-just-for-html-elements/)
- 📜 [通往更清晰React架构之路（第7部分）- 领域逻辑](https://profy.dev/article/react-architecture-domain-logic)
- 📦 [Headless UI React 2.1 - 简化的过渡API和改进的多对话框支持](https://tailwindcss.com/blog/2024-06-21-headless-ui-v2-1)
- 📦 [Storybook 8.2 - beforeAll测试钩子、增强的play函数、可移植故事、全新入门引导](https://github.com/storybookjs/storybook/releases/tag/v8.2.0)
- 📦 [React Flow 12.0 - 支持SSR、流计算、暗黑模式](https://www.xyflow.com/blog/react-flow-12-release)
- 📦 [Hono 4.5 - 兼容React 19的API](https://github.com/honojs/hono/releases/tag/v4.5.0)
- 🎥 [Dave Gray - 使用Next.js Server Actions和next-safe-action实现Toast通知模式](https://www.youtube.com/watch?v=A_061Vqh6Bc)
- 🎥 [Lazar Nikolov - 在Next.js中实现整洁架构模式](https://www.youtube.com/playlist?list=PLHQY5AFuyYYW8IJK16BxyTLZqTHxwmDww)
- 🎥 [Jolly Coding - NextJS 'use server'陷阱（意外数据泄露）](https://www.youtube.com/watch?v=yBEHKoaoZpY)
- 🎥 [Olivier Larose - React中GSAP与Framer Motion的对比](https://www.youtube.com/watch?v=_1QAJaC6Xwc)
- 🎙️ [本月React动态 - React 19延期（戏剧性事件）、为何没有JS版Laravel、TS 5.5新特性...](https://podcasters.spotify.com/pod/show/reactiflux/episodes/TMiR-2024-06-React-19-delayed-drama-ish--why-no-JS-Laravel--TS-5-5-and-more-e2lee77)

<SubscribeFormEmbed placement="middle" />

---

## 💸 赞助商 {#sponsor2}

[![WorkOS：面向B2B SaaS的现代身份平台](/emails/issues/189/WorkOS.jpg)](https://workos.com/?utm_source=thisweekinreact&utm_medium=newsletter&utm_campaign=q22024)

**[WorkOS：面向B2B SaaS的现代身份平台](https://workos.com/?utm_source=thisweekinreact&utm_medium=newsletter&utm_campaign=q22024)**

通过WorkOS，仅需几行代码即可开始向企业客户销售产品。

🔐 WorkOS提供完整的用户管理解决方案，支持**单点登录(SSO)、跨域身份管理系统(SCIM)、基于角色的访问控制(RBAC)和细粒度授权(FGA)**。

🏗️ API设计**灵活易用且模块化**，可按需选择功能并快速集成。

🎨 设计与用户体验至关重要。从文档质量到用户引导流程，我们**为开发者消除了所有不必要的复杂性**。

✨ 用户管理功能**免费支持高达100万月活用户(MAU)**，包含机器人防护、身份模拟、多因素认证(MFA)等功能。

🤝 WorkOS已获**Perplexity**、**Vercel**、**Webflow**等数百家领先初创企业信任。

使用[WorkOS](https://workos.com/?utm_source=thisweekinreact&utm_medium=newsletter&utm_campaign=q22024)为您的认证系统构建未来🚀

---

## 📱 React-Native {#react-native}

[![react-native-filament](/emails/issues/192/filament.jpg)](https://github.com/margelo/react-native-filament)

**[react-native-filament](https://github.com/margelo/react-native-filament)**

Margelo团队发布了一款基于Google Filament的实时物理3D渲染引擎，专为React Native打造。该引擎通过Metal/Vulkan实现GPU加速，在独立线程渲染，支持Reanimated，并已兼容新架构(New Architecture)和Expo。README文档清晰阐述了其与基于expo-gl的现有3D解决方案(expo-three和react-three-fiber RN)的区别。随着Skia和Filament的加入，React Native的2D/3D能力前景广阔。

---

[![Rise Tools](/emails/issues/192/rise.jpg)](https://rise.tools/)

**[Rise Tools](https://rise.tools/)**

这是一款创新的服务驱动UI解决方案，允许开发者无需重建/重新提交应用（甚至无需OTA更新）即可通过服务端部署新界面。其设计理念与React服务端组件模型相似，但采用不同的权衡策略：通过定义视图序列化协议，该方案实现了框架和语言无关性，虽然需要额外的手动配置。目前虽处于早期阶段，但极具发展潜力。

---

- 💸 [RevenueCat Paywalls - 为React Native应用提供可远程配置的付费墙解决方案](https://www.revenuecat.com/docs/tools/paywalls?utm_medium=sponsored&utm_source=thisWeekInReact&utm_campaign=general_sponsorship&utm_content=revenuecat-paywalls)
- 📣 [React Native 0.76 - Android最低支持版本将提升至Android 7.0 (API 24)](https://github.com/react-native-community/discussions-and-proposals/discussions/802)
- 👀 [More-reacty-native-demo](https://github.com/EvanBacon/more-reacty-native-demo): Evan Bacon尝试将原生视图暴露为小写JSX内置元素，无需导入即可直接使用，类似网页上的div元素。
- 📖 [Reanimated实战手册 - 通过真实案例学习](https://docs.swmansion.com/react-native-reanimated/examples/)
- 🗓️ [The Geek Conf](https://www.thegeekconf.com/?utm_source=thisweekinreact) - 🇩🇪 柏林 - 7月18日 & 25日 - 使用优惠码"TWIR"可享9折。明日远程活动最后购票日！
- 📜 [Expo - 通过PR预览加速迭代](https://expo.dev/blog/increase-iteration-speed-with-pr-previews): 新功能将EAS Updates与GitHub集成，自动将OTA更新作为PR提交状态发布。类似Vercel/Netlify为网页提供的优秀开发者体验，但面向移动端！个人建议是在PR评论中固定显示二维码。
- 📜 [使用框架构建React Native应用](https://reactnative.dev/blog/2024/06/25/use-a-framework-to-build-react-native-apps): React Native团队正式推荐使用Expo！如果你不使用框架，很可能正在自建轮子。
- 📜 [从Web到Native的React之旅](https://expo.dev/blog/from-web-to-native-with-react): Expo的Kadi创建了优秀资源帮助网页开发者学习React Native，包括对比React DOM与React Native内置元素、弹性盒模型差异、常见错误规避、需要学习的新原生知识，全面概述了React Native或Expo相关注意事项。
- 📜 [微软 - 在Mac上构建React Native Windows应用](https://devblogs.microsoft.com/react-native/2024-07-18-running-rnw-from-a-mac-md/): 无需Windows PC，可通过Microsoft Dev Box或Parallels使用Windows虚拟机。
- 📜 [使用React Native新架构和Swift开发App Clip](<https://ospfranco.com/app-clip-with-react-native-and-new-arch-(and-swift)/>)
- 📜 [通过ExecuTorch为移动应用引入原生AI - 第二部分：Android](https://blog.swmansion.com/bringing-native-ai-to-your-mobile-apps-with-executorch-part-ii-android-29431b6b9f7f)
- 📜 [React Native OMH地图库入门指南](https://www.callstack.com/blog/introduction-to-the-react-native-omh-maps-library)
- 📦 [React Navigation 7.0候选版](https://reactnavigation.org/blog/2024/06/27/react-navigation-7.0-rc/): 正式版即将发布，静态API和屏幕预加载API尤其令人期待。这是实现性能感知提升的第一步，未来可结合并发React特性如`<Activity>`。
- 📦 [FlashList 1.7 - 支持新架构！](https://github.com/Shopify/flash-list/releases/tag/v1.7.0)
- 📦 [Yoga 3.1 - 百分比间距、布局一致性及回归修复](https://www.yogalayout.dev/blog/announcing-yoga-3.1)
- 📦 [Reanimated 3.13 - 新架构支持、标签页共享元素过渡](https://github.com/software-mansion/react-native-reanimated/releases/tag/3.13.0)
- 📦 [React Native Primitives - 无样式的通用组件库，专注可访问性](https://github.com/roninoss/rn-primitives)

**扩展阅读:**

- 🐦 [React Native在Meta Quest设备上运行的演示](https://x.com/swmansion/status/1798736357206179920)
- 🐦 [Expo在Daylight DC-1设备上运行的演示](https://x.com/notbrent/status/1811134140265173178)
- 👀 [Flutter-Brownfield - 在现有Flutter应用中集成React Native的概念验证](https://github.com/callstack/flutter-brownfield)
- 📜 [使用Expo重建一款10年历史的iOS应用](https://expo.dev/blog/rebuilding-a-10-year-old-ios-app-with-expo)
- 📜 [使用Skia和Reanimated在React Native中构建图片轮播组件](https://www.tweag.io/blog/2024-07-04-image-transition-react-native-skia/)
- 📜 [发布双模块ESM格式的库](https://satya164.page/posts/publishing-dual-module-esm-libraries)
- 📜 [如何在Expo应用中实现本地存储？](https://scientyficworld.org/how-to-implement-local-storage-in-expo-app/)
- 📜 [赋能用户：使用React Native开发无障碍移动应用](https://commerce.nearform.com/blog/2024/empowering-users-developing-accessible-mobile-apps-using-react-native)
- 🔗 [Awesome-react-native-ui - 社区创建的React Native动画合集](https://mrpmohiburrahman.github.io/awesome-react-native-ui/)
- 📦 [React Native 0.75 RC.5版本发布](https://github.com/facebook/react-native/releases/tag/v0.75.0-rc.5)
- 🎙️ [火箭飞船第44期 - Yoga布局引擎与新架构（Delphine Bugner访谈）](https://podcast.galaxies.dev/episodes/044-yoga-layouting-and-new-architecture-with-delphine-bugner)
- 🎙️ [火箭飞船第45期 - 为海员开发的React Native应用（Gabriel Dierks访谈）](https://podcast.galaxies.dev/episodes/045-react-native-apps-for-seafarers-with-gabriel-dierks)
- 🎙️ [RNR第301期 - 解析Animated原生驱动的使用](https://www.reactnativeradio.com/episodes/rnr-301-rnr-explains-using-native-driver-for-animated)
- 🎙️ [RNR第302期 - 如何获得React Native工作（Taylor Desseyn访谈）](https://www.reactnativeradio.com/episodes/rnr-302-landing-a-react-native-job-with-taylor-desseyn)
- 🎥 [Simon Grimm - 12分钟从React过渡到React Native](https://www.youtube.com/watch?v=6UB3gw3SKfY)
- 🎥 [Simon Grimm - React Native vs Flutter技术选型指南](https://www.youtube.com/watch?v=AiG8-wHidiA)

---

## 🔀 其他 {#other}

- 👀 [TypeScript 5.6迭代计划](https://github.com/microsoft/TypeScript/issues/59250)
- 📜 [Ecma国际批准ECMAScript 2024标准 - 新特性解读](https://2ality.com/2024/06/ecmascript-2024.html)
- 📜 [加速JavaScript生态系列：隔离式声明](https://marvinh.dev/blog/speeding-up-javascript-ecosystem-part-10/)
- 📦 [Node 22.4 - 实验性Web Storage支持（localStorage/sessionStorage）](https://nodejs.org/en/blog/release/v22.4.0)
- 📦 [Node 22.5 - 实验性node:sqlite模块](https://nodejs.org/en/blog/release/v22.5.0)
- 📦 [pnpm 9.5 - 新增"catalogs"功能](https://pnpm.io/catalogs)
- 📦 [Vitest 2.0 - 改进的浏览器模式](https://github.com/vitest-dev/vitest/releases/tag/v2.0.0)

**扩展阅读：**

- 🔐 [Polyfill.io供应链攻击波及10万+网站](https://sansec.io/research/polyfill-supply-chain-attack)
- 📣 [Astro与Netlify达成官方部署合作](https://astro.build/blog/netlify-official-deployment-partner/)
- 📜 [2024年如何优化Google Lighthouse评分](https://blog.sentry.io/how-to-hack-your-google-lighthouse-scores-in-2024/)
- 📜 [终于该解释什么是渐进增强了](https://piccalil.li/blog/its-about-time-i-tried-to-explain-what-progressive-enhancement-actually-is/)
- 📜 [ESLint未来规划：语言无关的核心重构](https://eslint.org/blog/2024/07/whats-coming-next-for-eslint/)
- 📜 [TypeScript只是个Linter吗？](https://www.totaltypescript.com/is-typescript-just-a-linter)
- 📜 [Node.js流读写指南](https://blog.platformatic.dev/a-guide-to-reading-and-writing-nodejs-streams)
- 📜 [TypeScript 5.5：重磅发布](https://effectivetypescript.com/2024/07/02/ts-55/)
- 📦 [StackBlitz pkg.pr.new：为库提供持续预览版发布](https://github.com/stackblitz-labs/pkg.pr.new)
- 📦 [fetch-super-headers：带类型安全访问的Headers替代方案](https://github.com/mjackson/fetch-super-headers)
- 📦 [Deno 1.45：支持工作区与Monorepo](https://deno.com/blog/v1.45)
- 📦 [Rspack 1.0 Alpha：更小输出、模块合并、Lightning CSS与精简核心](https://www.rspack.dev/blog/announcing-1-0-alpha)
- 📦 [Mako：基于Rust的新款快速打包工具](https://makojs.dev/blog/mako-open-sourced)
- 📦 [Facebook memlab：JavaScript内存泄漏检测工具](https://github.com/facebook/memlab)

---

## 🤭 趣闻 {#fun}

[![alt](/emails/issues/192/meme.jpg)](https://x.com/flexbox_/status/1806786055057674337)

下期见！👋